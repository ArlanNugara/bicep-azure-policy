{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "policyInitiativeArray": {
      "value": [
        {
          "client": "<Your Value here>",
          "name": "Baseline-Azure-Policy-Initiative",
          "policyType": "Custom",
          "description": "This policy enables a set of definitions that can be deployed.",
          "policySetDefinitionDisplayName": "Baseline Azure Policy Set Definition",
          "policyInitiativeDisplayName": "Baseline Azure Policy Initiative",
          "allowed_regions_policy": {
            "name": "Allowed-Azure-Regions",
            "displayName": "Allowed Azure Regions",
            "description": "This policy allows resources to be created in the allowed locations.",
            "listOfAllowedLocations": ["canadaeast", "canadacentral"],
            "effect": "Audit"
          },
          "allowed_vms_sku_policy": {
            "name": "Allowed-VMs-SKU-type",
            "displayName": "Allowed VMs SKU type",
            "description": "This policy allows to create certain types of VMs SKU only.",
            "listOfAllowedSKUs": [
              "Standard_F4",
              "Standard_B2ms",
              "Standard_B4ms",
              "Standard_D2_v3",
              "Standard_B1s"
            ],
            "effect": "Audit"
          },
          "allowed_storage_account_SKUs_policy": {
            "name": "Allowed-storage-account-SKUs",
            "displayName": "Allowed storage account SKUs",
            "description": "This policy enables a set of storage account SKUs that can be deployed.",
            "listOfAllowedSKUs": [
              "Standard_LRS",
              "Standard_RAGRS",
              "Standard_GRS"
            ],
            "effect": "Audit"
          },
          "allowed_vm_extensions_policy": {
            "name": "Allowed-VM-extension-types",
            "displayName": "Allowed VM extension types",
            "description": "The list of approved extension types that can be installed.",
            "listOfAllowedExtensions": [
              "AzureNetworkWatcherExtension",
              "MDE.Windows",
              "Microsoft.Powershell.DSC"
            ],
            "effect": "Audit"
          },
          "allowed_subnets_for_public_ip_policy": {
            "name": "Allowed-Subnets-for-Public-IP",
            "displayName": "Allowed Subnets for Public IP",
            "description": "This policy audit the subnets Allowed to have Public IP Addresses.",
            "listOfAllowedSubnets": ["<Your Value here>"],
            "effect": "Audit"
          },
          "allowed_sql_version_policy": {
            "name": "Allowed-SQL-Server-version",
            "displayName": "Allowed SQL Server version",
            "description": "This policy ensures all SQL servers use allowed version only.",
            "SQLVersion": "12.0",
            "effect": "Audit"
          },
          "allowed_vms_os_version_policy": {
            "name": "Allowed-VMs-OS-versions",
            "displayName": "Allowed VMs OS versions",
            "description": "Reports VMs as non-compliant if the VM Image (OS) is not in the list of allowed OS image.",
            "windowsOSVersions": ["2019-Datacenter", "2016-Datacenter"],
            "linuxOSVersions": ["7.4", "7-LVM", "18.04-LTS"],
            "effect": "Audit"
          },
          "allowed_resource_type_policy": {
            "name": "Allowed-Azure-Resource-Type",
            "displayName": "Allowed Azure Resource Type",
            "description": "This policy enables you to specify the resource types that organization can deploy.",
            "effect": "Audit",
            "resourceList": [
              "Microsoft.Resources/subscriptions",
              "Microsoft.Resources/subscriptions/resourceGroups",
              "microsoft.synapse/workspaces/bigdatapools",
              "microsoft.network/applicationgateways",
              "microsoft.network/applicationgatewaywebapplicationfirewallpolicies",
              "microsoft.insights/components",
              "microsoft.network/applicationsecuritygroups",
              "microsoft.databricks/workspaces",
              "microsoft.containerinstance/containergroups",
              "microsoft.datadog/monitors",
              "microsoft.compute/disks",
              "microsoft.eventhub/namespaces",
              "microsoft.keyvault/vaults",
              "microsoft.network/loadbalancers",
              "microsoft.operationalinsights/querypacks",
              "microsoft.operationalinsights/workspaces",
              "microsoft.machinelearningservices/workspaces",
              "microsoft.managedidentity/userassignedidentities",
              "microsoft.network/natgateways",
              "microsoft.network/networkinterfaces",
              "microsoft.network/networksecuritygroups",
              "microsoft.network/networkwatchers",
              "microsoft.network/networkwatchers/flowlogs",
              "microsoft.network/privatednszones",
              "microsoft.network/privateendpoints",
              "microsoft.network/publicipaddresses",
              "Microsoft.Network/routeTables",
              "Microsoft.Network/routeTables/routes",
              "Microsoft.Network/virtualNetworkGateways",
              "Microsoft.Network/virtualNetworks/subnets",
              "Microsoft.Network/virtualNetworks/virtualNetworkPeerings",
              "Microsoft.Network/bastionHosts",
              "Microsoft.Network/networkSecurityGroups/securityRules",
              "Microsoft.Network/azureFirewalls",
              "Microsoft.Network/connections",
              "microsoft.operationsmanagement/solutions",
              "microsoft.sql/servers/databases",
              "microsoft.sql/servers",
              "microsoft.storage/storageaccounts",
              "Microsoft.Storage/storageAccounts/blobServices",
              "Microsoft.Storage/storageAccounts/tableServices",
              "Microsoft.Storage/storageAccounts/queueServices",
              "Microsoft.Storage/storageAccounts/fileServices",
              "microsoft.synapse/privatelinkhubs",
              "microsoft.synapse/workspaces",
              "microsoft.compute/virtualmachines",
              "microsoft.compute/virtualmachinescalesets",
              "microsoft.network/virtualnetworks",
              "Microsoft.Sql/servers/databases/auditingSettings",
              "Microsoft.Sql/servers/connectionPolicies",
              "Microsoft.Sql/servers/securityAlertPolicies",
              "Microsoft.Sql/servers/keys",
              "Microsoft.Sql/servers/databases/vulnerabilityAssessments",
              "Microsoft.Sql/servers/databases/geoBackupPolicies",
              "Microsoft.Sql/servers/encryptionProtector",
              "Microsoft.Sql/servers/databases/backupShortTermRetentionPolicies",
              "Microsoft.Sql/servers/databases/transparentDataEncryption",
              "Microsoft.Sql/servers/databases/extendedAuditingSettings",
              "Microsoft.Sql/servers/databases/backupLongTermRetentionPolicies",
              "Microsoft.Sql/servers/databases/ledgerDigestUploads",
              "Microsoft.Sql/servers/devOpsAuditingSettings",
              "Microsoft.Sql/servers/advisors",
              "Microsoft.Security/policies",
              "Microsoft.Security/settings",
              "Microsoft.Security/pricings",
              "Microsoft.Authorization/roleAssignments",
              "Microsoft.Authorization/policyAssignments",
              "Microsoft.Authorization/policySetDefinitions",
              "Microsoft.Security/autoProvisioningSettings",
              "Microsoft.Advisor/configurations",
              "Microsoft.Web/sites/hostNameBindings",
              "Microsoft.Web/sites/config",
              "Microsoft.Web/sites/basicPublishingCredentialsPolicies",
              "Microsoft.Web/serverfarms",
              "Microsoft.Web/sites",
              "Microsoft.Authorization/policydefinitions",
              "microsoft.sql/servers/auditingsettings",
              "microsoft.sql/servers/databases/securityalertpolicies",
              "microsoft.sql/servers/extendedauditingsettings",
              "microsoft.sql/servers/vulnerabilityassessments",
              "microsoft.sql/servers/databases/advisors",
              "microsoft.sql/servers/privateendpointconnections",
              "microsoft.network/privatednszones/soa",
              "microsoft.network/privateendpoints/privatelinkserviceproxies",
              "microsoft.network/privatednszones/virtualnetworklinks",
              "microsoft.network/privateendpoints/privatednszonegroups",
              "microsoft.sql/servers/privateendpointconnections",
              "microsoft.insights/diagnosticsettings",
              "microsoft.network/ddosprotectionplans",
              "microsoft.security/securitycontacts",
              "microsoft.compute/virtualmachines/extensions",
              "microsoft.alertsmanagement/smartdetectoralertrules",
              "microsoft.insights/actiongroups",
              "microsoft.eventgrid/systemtopics",
              "microsoft.eventgrid/systemtopics/eventsubscriptions",
              "microsoft.insights/scheduledqueryrules",
              "microsoft.operationalinsights/workspaces/linkedservices",
              "microsoft.policyinsights/eventgridfilters"
            ]
          },
          "diagnostic_setting_policy": {
            "name": "Diagnostic-setting",
            "displayName": "Diagnostic setting",
            "description": "Diagnostic setting for selected resource types.",
            "listOfDiagonosticSettings": [
              "microsoft.databricks/workspaces",
              "microsoft.containerinstance/containergroups",
              "microsoft.datadog/monitors",
              "microsoft.keyvault/vaults",
              "microsoft.network/loadbalancers",
              "microsoft.operationalinsights/querypacks",
              "microsoft.operationalinsights/workspaces",
              "microsoft.machinelearningservices/workspaces",
              "microsoft.managedidentity/userassignedidentities",
              "microsoft.network/natgateways",
              "microsoft.network/networksecuritygroups",
              "microsoft.network/publicipaddresses",
              "microsoft.operationsmanagement/solutions",
              "microsoft.storage/storageaccounts",
              "microsoft.synapse/workspaces",
              "microsoft.network/virtualnetworks"
            ],
            "effect": "auditifnotexists"
          },
          "diagnostics_logs_sends_to_log_analytics_workspace_policy": {
            "name": "Diagnostic-logs-to-send-to-Log-Analytics-workspace",
            "displayName": "Diagnostic logs to send to Log Analytics workspace",
            "description": "This policy for Azure resources diagnostic logs and metrics to be sent to centralised Log Analytics workspace.",
            "logAnalyticsWorkspace": "<Your Value here>",
            "listOfDiagonosticSettingsForResourceTypes": [
              "microsoft.synapse/workspaces/bigdatapools",
              "microsoft.network/applicationgateways",
              "microsoft.network/applicationgatewaywebapplicationfirewallpolicies",
              "microsoft.insights/components",
              "microsoft.network/applicationsecuritygroups",
              "microsoft.databricks/workspaces",
              "microsoft.containerinstance/containergroups",
              "microsoft.datadog/monitors",
              "microsoft.eventhub/namespaces",
              "microsoft.keyvault/vaults",
              "microsoft.network/loadbalancers",
              "microsoft.operationalinsights/querypacks",
              "microsoft.operationalinsights/workspaces",
              "microsoft.machinelearningservices/workspaces",
              "microsoft.managedidentity/userassignedidentities",
              "microsoft.network/natgateways",
              "microsoft.network/networksecuritygroups",
              "microsoft.network/publicipaddresses",
              "microsoft.operationsmanagement/solutions",
              "microsoft.storage/storageaccounts",
              "microsoft.synapse/workspaces",
              "microsoft.network/virtualnetworks"
            ],
            "effect": "auditifnotexists"
          },
          "tags_mandatory_policy": {
            "name": "Mandatory-Tags",
            "displayName": "Mandatory Tags",
            "description": "This policy Deny Resources without Mandatory Tags.",
            "tags": {
              "env": "Env",
              "customer": "Customer",
              "region": "Region",
              "createdBy": "Created By"
            },
            "effect": "audit"
          },
          "nsg_every_subnet_policy": {
            "name": "NSG-at-every-subnet",
            "displayName": "NSG at every subnet",
            "description": "Network security group should be available at every subnet.",
            "effect": "Audit"
          },
          "nsg_inbound_rules_policy": {
            "name": "NSG-inbound-rules",
            "displayName": "NSG rule that allow all inbound traffic",
            "description": "Network security group rules that allow all inbound traffic.",
            "effect": "Audit"
          },
          "ssl_storage_secure_transfer_setting_policy": {
            "name": "Https-only-for-Storage-Transfers",
            "displayName": "Https only for Storage Transfers",
            "description": "HTTPS setting on storage account",
            "effect": "Audit"
          },
          "network_watcher_enable_policy": {
            "name": "Network-Watcher-Enable",
            "RGName": "NetworkWatcherRG",
            "displayName": "Network watcher enable when virtual networks are created",
            "description": "This policy creates a network watcher resource in regions with virtual networks.",
            "effect": "AuditIfNotExists"
          },
          "firewall_internet_traffic_policy": {
            "name": "Azure-Firewall-For-Internet-Traffic",
            "displayName": "Azure Firewall for Internet Traffic",
            "description": "Azure Firewall for Internet Traffic.",
            "effect": "auditifnotexists"
          },
          "ddos_protection_policy": {
            "name": "DDOS-Protection",
            "displayName": "DDOS Protection",
            "description": "DDOS Protection for Virtual Network.",
            "effect": "audit"
          },
          "network_interface_ip_forwarding_policy": {
            "name": "Network-Interface-IP-forwarding",
            "displayName": "Network Interface IP forwarding",
            "description": "Network Interface IP forwarding.",
            "effect": "audit"
          },
          "vm_management_port_policy": {
            "name": "VM-Management-Port",
            "displayName": "VM Management Port",
            "description": "This policy audits for Virtual Machine Management Port.",
            "effect": "auditifnotexists"
          },
          "vm_managed_disk_policy": {
            "name": "VM-Managed-Disk",
            "displayName": "VM Managed Disk",
            "description": "This policy audits for Virtual Machine Managed Disk.",
            "effect": "audit"
          },
          "vm_internet_facing_nsg_policy": {
            "name": "VM-Internet-Facing-NSG",
            "displayName": "VM Internet Facing NSG",
            "description": "This policy audits for Virtual Machine Managed Disk.",
            "effect": "auditifnotexists"
          },
          "vm_encryption_policy": {
            "name": "VM-Encryption",
            "displayName": "VM Encryption",
            "description": "This policy audits for Virtual Machine Managed Disk.",
            "effect": "audit"
          },
          "tags_optional_policy": {
            "name": "Optional-Tags",
            "displayName": "Optional Tags",
            "description": "All resources in which optional Tags doesn't exisits.",
            "tags": {
              "app": "App",
              "costCenter": "Cost Center",
              "department": "Department",
              "owner": "Owner",
              "policy": "Policy",
              "product": "Product",
              "stakeholders": "Stakeholders",
              "tiers": "Tier"
            },
            "effect": "audit"
          },
          "storage_account_network_access_policy": {
            "name": "Storage-Account-Network-Access",
            "displayName": "Storage Account Network Access",
            "description": "This policy audits for storage account network access.",
            "effect": "audit"
          },
          "storage_account_key_expiry_policy": {
            "name": "Storage-Account-Key-Expiry",
            "displayName": "Storage Account Key Expiry",
            "description": "This policy audits for storage account expired keys.",
            "effect": "audit"
          },
          "sql_server_network_access_policy": {
            "name": "SQL-Server-Network-Access",
            "displayName": "SQL Server Network Access",
            "description": "This policy audits for sql server network access.",
            "effect": "audit"
          },
          "sql_database_tls_version_policy": {
            "name": "SQL-Database-TLS-version",
            "displayName": "SQL Database TLS version",
            "description": "This policy audits for SQL Database TLS version.",
            "sqlDatabaseAllowedTLSVersion": "1.2",
            "effect": "audit"
          },
          "sql_database_private_endpoint_policy": {
            "name": "SQL-Database-Private-Endpoint",
            "displayName": "SQL Database Private Endpoint",
            "description": "This policy audits for SQL Database Private Endpoint.",
            "effect": "audit"
          },
          "keys_vault_soft_delete_policy": {
            "name": "Keys-Vault-Soft-Delete",
            "displayName": "Keys Vault Soft Delete",
            "description": "Keys Vault for soft delete status.",
            "effect": "audit"
          },
          "keys_vault_purge_protection_policy": {
            "name": "Keys-Vault-Purge-Protection",
            "displayName": "Keys Vault Purge Protection",
            "description": "Keys Vault for purge protection status.",
            "effect": "audit"
          }
        }
      ]
    }
  }
}
